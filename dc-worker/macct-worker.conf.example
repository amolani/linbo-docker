# LINBO Docker DC Worker Configuration
# Copy to /etc/macct-worker.conf and adjust values

# Redis connection (LINBO Docker Redis)
# This must be reachable from the AD DC
REDIS_HOST=10.0.0.1
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# LINBO API connection
# This must be reachable from the AD DC
API_URL=http://10.0.0.1:3000/api/v1
API_KEY=linbo-internal-secret

# Consumer identification
# Should be unique per worker instance
CONSUMER_NAME=dc-01

# Log directory
LOG_DIR=/var/log/macct

# Path to repair_macct.py script
# Default location on linuxmuster.net server
REPAIR_SCRIPT=/usr/share/linuxmuster/linbo/repair_macct.py

# =============================================================================
# Host Provisioning (Phase 11)
# =============================================================================

# Multi-school support: {school} placeholder in paths (default: default-school)
SCHOOL=default-school
DEVICES_CSV_MASTER=/etc/linuxmuster/sophomorix/{school}/devices.csv
DEVICES_CSV_DELTA=/etc/linuxmuster/sophomorix/{school}/linbo-docker.devices.csv
IMPORT_SCRIPT=/usr/sbin/linuxmuster-import-devices
PROVISION_LOCK_FILE=/var/lock/linbo-provision.lock

# DNS domain for verify checks
# Set to 'auto' to detect from Samba: LINBO_DOMAIN=auto
LINBO_DOMAIN=linuxmuster.lan

# DHCP verify file (leave empty to skip DHCP verify)
DHCP_VERIFY_FILE=/etc/dhcp/devices/{school}.conf
# DHCP_VERIFY_FILE=

# Samba auth for explicit AD/DNS cleanup on host delete
# Empty = skip explicit cleanup, only warn if import-devices didn't remove
SAMBA_TOOL_AUTH=-U administrator%secret
# or: SAMBA_TOOL_AUTH=--use-kerberos=required

# Reverse DNS zone octets (3 = /24, 2 = /16)
REV_DNS_OCTETS=3

# Batching: max hosts per import-devices run + debounce window
PROVISION_BATCH_SIZE=50
PROVISION_DEBOUNCE_SEC=5

# NOTE: Dry-run is controlled by API (DC_PROVISIONING_DRYRUN env in docker-compose.yml)
# Worker reads dryRun from Operation.options â€” no separate Worker ENV needed
